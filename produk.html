<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="images/favicon/favicon.ico" type="image/x-icon">
  <title>Produk</title>
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="vendor/bootstrap/solar.css">
  <link rel="stylesheet" href="vendor/bootstrap/bootstrap-icons.css">
  <script src="vendor/bootstrap/bootstrap.bundle.min.js"></script>
  <script src="js/jquery-3.6.3.min.js"></script>
  <style>
    img.logo {
   /* height mengatur tinggi elemen */
   height: 60px;
   width: 120px;
   /* penjelasan margin mirip dengan padding, fungsinya untuk memberi jarak pada elemen */
   margin-left: 40px;
}

     #huruf a{
            color: black;
            font-weight: bold;
        }
        header,footer{
            background-color: blue;
        }
        .pilih{
            color: black;
            margin-top: 5px;
        }
        #nava {
   background-color: #4612ca;
   /* box-shadow membuat efek bayangan */
   box-shadow: 0 3px 7px -2px #000;
   /* width mengatur lebar elemen. 100% agar lebarnya full dari kiri sampai kanan layar */
   width: 100%;
   font-weight: bold;
   font-size: 15pt;
}
       
#nava :hover{
   transition: all 0.3s ease;

   /* border-radius  Membuat sudut membulat */
   border-radius: 15px;
   padding-bottom: 2px;
   color: black;
   /* box-shadow membuat efek bayangan */
   
}

 #huruf a {
   color: aqua;
   padding-left: 8px;
   padding-right: 8px;
   margin-left: 0%;
   
}

    .hitam {
      color: black;
    }


    /* tulis kode CSS internal di bawah sini *
           

        /* Batas Akhir penulisan kode CSS internal */
  </style>
</head>

<body>
  <!-- Tulis Kode Bootstrap Di Bawah Sini -->

  <nav id="nava" class="navbar navbar-dark navbar-expand-lg bisadicopy">
    <div class="container">
      <a class="navbar-brand" href="https://www.rikikurnia.com">
        <img class="logo" src="images/logo/logo_kuy.png" height="40" alt="image">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav11" aria-controls="navbarNav11" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav11">
        <ul id="huruf" class="navbar-nav ms-auto btn-outline-light">
          <li class="nav-item active">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#best-seller">Best Seller</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#our-team">Our Team</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#contact-us">Contact Us</a>
          </li>

        </ul>
        <a href="cart.html" class="btn btn-outline-light position-relative">
          <i class="bi bi-cart4"></i>
          <span id="cart_icon"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              0
          </span>
      </a>
        <a class="btn btn-outline-light ms-md-3" href="https://wa.me/6281290465033">
          <i class="bi bi-whatsapp"></i> Chat</a>
      </div>
    </div>
  </nav>

  <section class="riki-block produk text-center my-5 py-5">
    <div class="container">
      <h1>Pilih Produk Anda</h1>
      <p class="fs-4">Kualitas terbaik biji kopi pilihan, fresh diambil langsung dari petani</p>
      <hr class="border border-dark border-3 opacity-75">

      <!-- Ini Untuk Select -->
      <div class="row gap-2 gap-md-0">
        <div class="col-md-4">
          <div class="input-group input-group-lg h-100">
            <button aria-readonly="true" disabled class="btn btn-danger" type="button" id="btn-cari-produk">
              <i class="bi bi-search"></i>
            </button>
            <input id="cari_produk" type="search" class="form-control" placeholder="Cari Produk ..." aria-label="Cari produk search" />
          </div>
        </div>

        <div class="col-md-4">
          <div class="form-floating">

            <select class="form-select" id="select_kopi">
              <option selected value="">Semua</option>
              <option value="arabica">Arabica</option>
              <option value="robusta">Robusta</option>
              <option value="nonkopi">Non Kopi</option>
            </select>
            <label class="hitam" for="select_kopi">Pilih Jenis Kopi</label>
          </div>
        </div>


       


      <div id="baris_produk" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 text-center mt-5" id="baris_produk">





      </div>
    </div>
  </section>

  <footer class="riki-block footer-small py-4 ">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-12 col-md-8">
          <ul class="nav justify-content-center justify-content-md-start">
            <li class="nav-item active">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#best-seller">Best Seller</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#our-team">Our Team</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#contact-us">Contact Us</a>
            </li>

          </ul>
        </div>

        <div class="col-12 col-md-4 mt-4 mt-md-0 text-center text-md-right">
          &copy; 2023 Kopi Kuy &amp; Tim . All Rights Reserved
        </div>
      </div>
    </div>
  </footer>

  <!-- Batas Akhir penulisan kode Bootstrap -->
  <script>
    /* Tulis Javascript Di bawah Sini */
    var sumber = "https://rikikurnia.com/prakerja/api/kopi"
    var sumber2 = "data.json"

    /* 
    kita buat dulu variable global data kopi
    supaya nanti data saat melakukan getjson
    tersimpan di variabel ini.
    variable global adalah var yang di tulis di luar function()
    tanda [] menandakan array (kumpulan data) kosong
    
    data_kopi_mentah berisi data kopi sebelum melakukan pencarian
    */
    var data_kopi = []
    var data_kopi_mentah = []

    /*
    
    disini saya buat dulu fungsi pengambilan data
    agar lebih simple dan dapat berkali2 dijalankan
    tanpa harus tulis kode getJSon berkali kali
    fungsi ambilData dapat menerima variabel 'dipilih'
    yang akan dikirim oleh select onchange
    */

    function ambilData(dipilih) {
      $.getJSON(sumber2).then(function(data) {
        /*
        data yang sudah diambil dan di filter
        akan saya simpan ke var data_kopi dan data_kopi_mentah
        yang sudah saya deklarasi di atas secara global
        maka tidak oerlu lagi tulis var data_kopi
        */

        if (dipilih == "") {
          data_kopi = []
          data_kopi.push(...data.arabica)
          data_kopi.push(...data.robusta)
          data_kopi.push(...data.nonkopi)
        } else {
          data_kopi = data[dipilih]
        }


        data_kopi_mentah = data_kopi

        console.log("hasil getjson", data_kopi)

        /* menjalankan fungsi buat tampilan*/
        buatTampilan()


      })

    }

    ambilData("")

    /* fungsi buat tampilan
    untuk memodifikasi dengan innerHTML
    agar baris produk berisi file kopi yang sesuai
    */

    function buatTampilan() {
      var template = ""
      data_kopi.forEach(item => {
        template += `<div class="col mb-4">
                                          <div class="card">
                                              <img src="${item.foto}" style="height: 320px ;" class="card-img-top" alt="...">
                                              <div class="card-body">
                                                  <h5 class="card-title">${item.nama}</h5>
                                                  <div class="row hargasize my-4">
                                                      <div class="col">
                                                          ${item.size}
                                                      </div>
                                                      <div class="col">
                                                          ${item.harga}
                                                      </div>
                                                  </div>
                                                  <button onclick='addToCart(${JSON.stringify({ nama: item.nama, harga: item.harga, foto: item.foto, hargaint: (item.harga.split(".").join("")) * 1, qty: 1 })})' href="${item.link}" class="addToCart btn btn-success w-100">
                                <i class="bi bi-cart4"></i> Add To Cart
                            </button>
                                              </div>
                                          </div>
                                      </div>`
      })

      baris_produk.innerHTML = template
    }


    select_kopi.onchange = function() {
      /* kosongkan kolom pencarian setelah terjadi perubahan select */
      cari_produk.value = ""

      var dipilih = select_kopi.value
      ambilData(dipilih);

    }

    
  

    cari_produk.onkeyup = function() {

      /*
      buat variabel untuk menyimpan kata yang diketik di pencarian
     kita gunakan toLowerCase supaya kaya pencarian
     dan produk yang dicari tidak case sensitif (beda besar kecil huruf di javascript akan dianggap beda.
     kopi dan Kopi akan dianggap beda)
      */
      var pencarian = cari_produk.value.toLowerCase()

      /*
      buat fungsi if, jika kolom oencarian kosong
      maka data yang ditampilkan adalah data_kopi_mentah (semua data)
      */

      if (pencarian == "") {
        data_kopi = data_kopi_mentah
      } else {
        /* 
      
      untuk pencarian kita gunakan filter dan nilai dari data_kopi 
      akan kita ubah berdasarkan pencarian
      
      */


        data_kopi = data_kopi_mentah.filter(item => {
          /*
          fungsi ini akan membuat data_kopi hanya berisi
          item2 yang field nama nya sama dengan yang ada di pencarian
          */
          return item.nama.toLowerCase().includes(pencarian)
        })

        console.log("pencarian", data_kopi)

      }

      buatTampilan()

    }
    var list_belanja = []
        function addToCart(item) {
            //itemObj = JSON.parse(item)
            list_belanja.push(item)
            localStorage.setItem("list_belanja", JSON.stringify(list_belanja))
            alert("Berhasil Menambah Produk")
            updateCartIcon()
        }
        function updateCartIcon() {
            cart_icon.classList.add("d-none")
            let list_belanja = localStorage.getItem("list_belanja")
            if (list_belanja != null) {
                list_belanja = JSON.parse(list_belanja)
                cart_icon.textContent = list_belanja.length
                if (list_belanja.length > 0) cart_icon.classList.remove("d-none")
            }
        }
        updateCartIcon()

    

    /* Batas Akhir penulisan kode Javascript */
  </script>
</body>

</html>